<!DOCTYPE html>
<link rel='stylesheet' type='text/css' href='public/main.css'>
<html>
<head>
  <title>Thermostat</title>
  <script src="src/Thermostat.js"></script>
  <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
</head>
<body>
    <h1>Thermostat</h1>
    <section>
    <h1 id="temperature"></h1>
    <h1 id="use"></h1>
      <button id="down"> Down </button>
      <button id='up'> Up </button>
      <button id='reset-temp'> Reset </button>
      <button id='usage'> Usage </button>
    <p>
        Power saving mode is <span id='power-saving-status'>on</span>
    </p>
    <p>
      <button id='power-saving-on'>PSM on</button>
      <button id='power-saving-off'>PSM off</button>
    </p>
  </section>
  <section>
    <h1>Current temperature: <span id="current-temperature"></span></h1>
    <form id="select-city">
      <input id="current-city" type="text" placeholder="Enter a city"></input>
      <input type="submit"></input>
    </form>

    <!-- <select id="select-city">
      <option value="london">London</option>
      <option value="newyork">New York</option>
      <option value="paris">Paris</option>
      <option value="tokyo">Tokyo</option>
    </select> -->
  </section>
  <script>
    $( document ).ready(function() {
      var thermostat = new Thermostat();
      $('#temperature').text(thermostat.temperature);

      $('#up').on('click', function(){
        thermostat.up();
        updateTemperature();
      });

      $('#down').on('click', function(){
        thermostat.down();
        updateTemperature();
      });

      $('#power-saving-off').on('click', function(){
        thermostat.powerSavingOff();
        $('#power-saving-status').text('off');
      });

      $('#power-saving-on').on('click', function() {
        thermostat.powerSavingOn();
        updateTemperature();
        $('#power-saving-status').text('on');
      });

      $('#usage').on('click', function() {
        $('#use').text(thermostat.usage());
      });

      $('#reset-temp').on('click', function(){
        thermostat.reset();
        updateTemperature();
      });

      $.get('http://api.openweathermap.org/data/2.5/weather?q=London&appid=a3d9eb01d4de82b9b8d0849ef604dbed&units=metric', function(data) {
        $('#current-temperature').text(data.main.temp);
      });

      $('#select-city').submit(function(event) {
        event.preventDefault();
        var city = $('#current-city').val();
        displayWeather(city);
      });

      function updateTemperature(){
        $('#temperature').text(thermostat.temperature);
        $('#temperature').attr('class', thermostat.usage());
      };

      function displayWeather(city) {
        var url = 'http://api.openweathermap.org/data/2.5/weather?q=' + city;
        var token = '&appid=a3d9eb01d4de82b9b8d0849ef604dbed';
        var units = '&units=metric';
        $.get(url + token + units, function(data) {
            $('#current-temperature').text(data.main.temp);
        });
      };
    });
  </script>
</body>
</html>
